python3 train.py --model unet --data_dir ./data --epochs 100 --batch_size 64 --lr 1e-4 --ssim_weight 0.0
Loading data from ./data...
Loading cached training data from ./cache/train_volumes.npz
Train: 16 subjects (3200 slices)
Val:   2 subjects (400 slices)
Model: unet (31,042,369 params)
Using 2 GPUs

Epoch |      Train |        Val |         LR |   Time
-------------------------------------------------------
    1 |   0.089087 |   0.072045 |   1.00e-04 |   6.3s
  ↳ Saved best model (val=0.072045)
    2 |   0.055203 |   0.065646 |   9.99e-05 |   5.7s
  ↳ Saved best model (val=0.065646)
    3 |   0.050022 |   0.059418 |   9.98e-05 |   5.7s
  ↳ Saved best model (val=0.059418)
    4 |   0.047310 |   0.056764 |   9.96e-05 |   5.7s
  ↳ Saved best model (val=0.056764)
    5 |   0.044995 |   0.054996 |   9.94e-05 |   5.7s
  ↳ Saved best model (val=0.054996)
    6 |   0.043265 |   0.053481 |   9.91e-05 |   5.7s
  ↳ Saved best model (val=0.053481)
    7 |   0.041267 |   0.055311 |   9.88e-05 |   5.7s
    8 |   0.038845 |   0.054599 |   9.84e-05 |   5.7s
    9 |   0.036533 |   0.054675 |   9.80e-05 |   5.8s
   10 |   0.034219 |   0.051626 |   9.76e-05 |   5.8s
  ↳ Saved best model (val=0.051626)
   11 |   0.032845 |   0.056760 |   9.70e-05 |   5.8s
   12 |   0.032020 |   0.051895 |   9.65e-05 |   5.8s
   13 |   0.030495 |   0.053040 |   9.59e-05 |   5.8s
   14 |   0.029034 |   0.053557 |   9.52e-05 |   5.8s
   15 |   0.027745 |   0.054314 |   9.46e-05 |   5.8s
   16 |   0.026955 |   0.051493 |   9.38e-05 |   5.8s
  ↳ Saved best model (val=0.051493)
   17 |   0.026073 |   0.050440 |   9.30e-05 |   5.8s
  ↳ Saved best model (val=0.050440)
   18 |   0.025598 |   0.050066 |   9.22e-05 |   5.9s
  ↳ Saved best model (val=0.050066)
   19 |   0.024621 |   0.053748 |   9.14e-05 |   5.9s
   20 |   0.023932 |   0.050825 |   9.05e-05 |   5.9s
   21 |   0.023397 |   0.049840 |   8.95e-05 |   5.9s
  ↳ Saved best model (val=0.049840)
   22 |   0.022674 |   0.051810 |   8.85e-05 |   5.9s
   23 |   0.022098 |   0.050453 |   8.75e-05 |   5.9s
   24 |   0.021672 |   0.050945 |   8.64e-05 |   5.9s
   25 |   0.021122 |   0.050885 |   8.54e-05 |   5.9s
   26 |   0.020713 |   0.049097 |   8.42e-05 |   5.9s
  ↳ Saved best model (val=0.049097)
   27 |   0.020466 |   0.052876 |   8.31e-05 |   5.9s
   28 |   0.019744 |   0.051006 |   8.19e-05 |   6.0s
   29 |   0.019261 |   0.050785 |   8.06e-05 |   6.0s
   30 |   0.019181 |   0.049015 |   7.94e-05 |   6.0s
  ↳ Saved best model (val=0.049015)
   31 |   0.019012 |   0.050241 |   7.81e-05 |   6.0s
   32 |   0.018848 |   0.050770 |   7.68e-05 |   6.0s
   33 |   0.018585 |   0.051446 |   7.55e-05 |   6.0s
   34 |   0.018061 |   0.051787 |   7.41e-05 |   6.0s
   35 |   0.017535 |   0.050752 |   7.27e-05 |   6.0s
   36 |   0.017886 |   0.051080 |   7.13e-05 |   6.0s
   37 |   0.017429 |   0.048746 |   6.99e-05 |   6.1s
  ↳ Saved best model (val=0.048746)
   38 |   0.017178 |   0.051135 |   6.84e-05 |   6.0s
   39 |   0.016748 |   0.051575 |   6.69e-05 |   6.1s
   40 |   0.016314 |   0.052039 |   6.55e-05 |   6.1s
   41 |   0.016302 |   0.053683 |   6.39e-05 |   6.1s
   42 |   0.016255 |   0.052510 |   6.24e-05 |   6.1s
   43 |   0.016222 |   0.052127 |   6.09e-05 |   6.1s
   44 |   0.015752 |   0.051365 |   5.94e-05 |   6.1s
   45 |   0.015790 |   0.050280 |   5.78e-05 |   6.1s
   46 |   0.015489 |   0.052447 |   5.63e-05 |   6.1s
   47 |   0.015075 |   0.050839 |   5.47e-05 |   6.2s
   48 |   0.015032 |   0.051247 |   5.31e-05 |   6.2s
   49 |   0.014912 |   0.050792 |   5.16e-05 |   6.2s
   50 |   0.015058 |   0.051964 |   5.00e-05 |   6.2s
   51 |   0.014659 |   0.049912 |   4.84e-05 |   6.2s
   52 |   0.014712 |   0.051392 |   4.69e-05 |   6.2s
   53 |   0.014607 |   0.051385 |   4.53e-05 |   6.2s
   54 |   0.014779 |   0.050847 |   4.37e-05 |   6.3s
   55 |   0.014368 |   0.050698 |   4.22e-05 |   6.2s
   56 |   0.014139 |   0.051444 |   4.06e-05 |   6.2s
   57 |   0.013819 |   0.051405 |   3.91e-05 |   6.2s
   58 |   0.013696 |   0.051240 |   3.76e-05 |   6.2s
   59 |   0.013824 |   0.049841 |   3.61e-05 |   6.3s
   60 |   0.013752 |   0.051145 |   3.45e-05 |   6.3s
   61 |   0.013500 |   0.051598 |   3.31e-05 |   6.3s
   62 |   0.013442 |   0.051229 |   3.16e-05 |   6.3s
   63 |   0.013269 |   0.051816 |   3.01e-05 |   6.3s
   64 |   0.013231 |   0.051358 |   2.87e-05 |   6.3s
   65 |   0.013136 |   0.051242 |   2.73e-05 |   6.3s
   66 |   0.013110 |   0.050828 |   2.59e-05 |   6.4s
   67 |   0.012965 |   0.050882 |   2.45e-05 |   6.3s
   68 |   0.012845 |   0.051544 |   2.32e-05 |   6.3s
   69 |   0.012689 |   0.051566 |   2.19e-05 |   6.3s
   70 |   0.012684 |   0.051375 |   2.06e-05 |   6.3s
   71 |   0.012655 |   0.051876 |   1.94e-05 |   6.3s
   72 |   0.012543 |   0.050745 |   1.81e-05 |   6.4s
   73 |   0.012434 |   0.051002 |   1.69e-05 |   6.4s
   74 |   0.012430 |   0.051787 |   1.58e-05 |   6.4s
   75 |   0.012395 |   0.050917 |   1.46e-05 |   6.4s
   76 |   0.012391 |   0.051709 |   1.36e-05 |   6.4s
   77 |   0.012314 |   0.051226 |   1.25e-05 |   6.4s
   78 |   0.012271 |   0.051175 |   1.15e-05 |   6.4s
   79 |   0.012212 |   0.051278 |   1.05e-05 |   6.4s
   80 |   0.012178 |   0.051126 |   9.55e-06 |   6.4s
   81 |   0.012121 |   0.051298 |   8.65e-06 |   6.4s
   82 |   0.012099 |   0.051387 |   7.78e-06 |   6.4s
   83 |   0.012097 |   0.051145 |   6.96e-06 |   6.5s
   84 |   0.011989 |   0.051538 |   6.18e-06 |   6.4s
   85 |   0.012022 |   0.051150 |   5.45e-06 |   6.5s
   86 |   0.011967 |   0.051279 |   4.76e-06 |   6.5s
   87 |   0.011976 |   0.050853 |   4.11e-06 |   6.5s
   88 |   0.011908 |   0.051236 |   3.51e-06 |   6.5s
   89 |   0.011884 |   0.051290 |   2.96e-06 |   6.5s
   90 |   0.011861 |   0.051384 |   2.45e-06 |   6.6s
   91 |   0.011891 |   0.051281 |   1.99e-06 |   6.5s
   92 |   0.011890 |   0.051380 |   1.57e-06 |   6.5s
   93 |   0.011825 |   0.051247 |   1.20e-06 |   6.5s
   94 |   0.011783 |   0.051359 |   8.86e-07 |   6.5s
   95 |   0.011842 |   0.051400 |   6.16e-07 |   6.5s
   96 |   0.011796 |   0.051252 |   3.94e-07 |   6.5s
   97 |   0.011766 |   0.051271 |   2.22e-07 |   6.5s
   98 |   0.011791 |   0.051215 |   9.87e-08 |   6.6s
   99 |   0.011731 |   0.051388 |   2.47e-08 |   6.6s
  100 |   0.011775 |   0.051274 |   0.00e+00 |   6.7s

Done. Best val loss: 0.048746

Kaggle public score: 0.5162

